<!DOCTYPE html>
<html>
	<head>
		<title>Zoomable Canvas with Lines Between Points</title>
		<script src="https://d3js.org/d3.v6.min.js"></script>
		<style>
			#plotCanvas {
				border: 1px solid #000;
			}
			#spectrumCanvas {
				border: 1px solid #000;
			}
			#container {
				width: 1000px;
				margin: 0 auto;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<div id="container">
			<canvas id="plotCanvas" width="1000" height="200"></canvas>
			<canvas id="spectrumCanvas" width="1000" height="600"></canvas>
		</div>
		<script>
			window.addEventListener("load", async function () {
				const plotCanvas = document.getElementById("plotCanvas");
				const offscreenPlotCanvas = plotCanvas.transferControlToOffscreen();
				const worker = new Worker("offscreen_worker.js");

				// Post the offscreen canvas and points to the worker
				worker.postMessage({ type: "plotCanvas", canvas: offscreenPlotCanvas }, [
					offscreenPlotCanvas,
				]);

				const spectrumCanvas = document.getElementById("spectrumCanvas");
				const offscreenSpectrumCanvas = spectrumCanvas.transferControlToOffscreen();
				worker.postMessage(
					{ type: "spectrumCanvas", canvas: offscreenSpectrumCanvas },
					[offscreenSpectrumCanvas]
				);

				const update = setInterval(() => {
					worker.postMessage({ type: "update" });
				}, 100);
			});
		</script>
	</body>
</html>
